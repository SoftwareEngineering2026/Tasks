# 101. Git

## Цели работы

- Освоить базовые команды Git: init, status, add, commit, log, show.
- Научиться работать с ветками, merge и rebase.
- Освоить форк‑workflow.
- Научиться создавать Pull Request и проходить простой code review.
- Аккуратно разрешать конфликты и использовать `.gitignore`.

---

## 1. Подготовка окружения

1. Установите:
   - Git: https://git-scm.com (Windows, macOS, Linux).
   - Любой текстовый редактор (Notepad++, VS Code и т.п.).

2. Настройте имя и почту (почта должна совпадать с GitHub):
   ```bash
   git config --global user.name "Ваше Имя"
   git config --global user.email "ваш_email@пример.com"
   ```

3. Проверьте конфигурацию:
   ```bash
   git config --list
   git --version
   ```

4. Создайте на GitHub новый публичный репозиторий с названием `git-lab-вашафамилия` (например, `git-lab-ivanov`).
   - Нажмите "+" в правом верхнем углу → "New repository".
   - Repository name: `git-lab-вашафамилия`.
   - Выберите "Public".
   - **Не добавляйте** README, .gitignore или license (создадим их вручную).
   - Нажмите "Create repository".

---

## 2. Локальная работа в личном репозитории

### 2.1. Инициализация и первый коммит

1. Создайте локальную папку и инициализируйте Git-репозиторий:
   ```bash
   mkdir git-lab-вашафамилия
   cd git-lab-вашафамилия
   git init
   ```

2. Свяжите локальный репозиторий с созданным на GitHub:
   ```bash
   git remote add origin https://github.com/ВАШ_ЛОГИН/git-lab-вашафамилия.git
   ```

3. Создайте файл `readme.txt` со следующей структурой:
   ```text
   ВАШАГРУППА ВашаФамилия И.О.
   ```

4. Выполните первый коммит:
   ```bash
   git add readme.txt
   git commit -m "Добавлен базовый readme с ФИО и группой"
   ```

5. Отправьте изменения в ваш репозиторий на GitHub:
   ```bash
   git push -u origin main
   ```
   (Если ваша основная ветка называется `master`, используйте `git push -u origin master`)

---

## 3. Работа с изменениями и коммитами

### 3.1. Второй коммит: оценка

1. Добавьте во **вторую строку** `readme.txt` оценку (1–5):
   ```text
   211 Иванов И.И.
   5
   ```

2. Сделайте коммит:
   ```bash
   git add readme.txt
   git commit -m "Добавлена оценка текущего статуса"
   ```

### 3.2. Amend последнего коммита

1. Добавьте **третьей строкой** название предмета:
   ```text
   211 Иванов И.И.
   5
   Программная инженерия
   ```

2. Измените последний коммит:
   ```bash
   git add readme.txt
   git commit --amend
   ```
   - В редакторе можно изменить сообщение коммита или оставить прежнее.
   - Сохраните и закройте редактор.

### 3.3. Третий коммит

1. Добавьте **четвёртой строкой** платформу, где проходят занятия:
   ```text
   211 Иванов И.И.
   5
   Программная инженерия
   МТС-линк
   ```

2. Создайте новый коммит:
   ```bash
   git add readme.txt
   git commit -m "Добавлена платформа видеоконференций"
   ```

3. Проверьте состояние:
   ```bash
   git status    # working tree clean
   git log --oneline
   ```

---

## 4. Откат изменений (`git revert`)

1. Найдите хэш **третьего** коммита (с платформой):
   ```bash
   git log --oneline
   ```

2. Выполните откат этого коммита:
   ```bash
   git revert ХЭШ_ТРЕТЬЕГО_КОММИТА
   ```
   - В открывшемся редакторе оставьте сообщение по умолчанию.
   - Сохраните и закройте редактор.

3. Убедитесь, что в `readme.txt` удалена строка с платформой.

4. Проверьте историю:
   ```bash
   git log --oneline
   ```
   Должен появиться новый коммит с сообщением об отмене.

---

## 5. Игнорирование временных файлов

1. Создайте временный файл:
   ```bash
   echo "Временные данные" > temporary.tmp
   ```

2. Проверьте статус:
   ```bash
   git status
   ```
   Файл `temporary.tmp` будет отображаться как неотслеживаемый.

3. Создайте `.gitignore`:
   ```bash
   echo "*.tmp" > .gitignore
   ```

4. Снова проверьте статус:
   ```bash
   git status
   ```
   Теперь `temporary.tmp` не должен отображаться.

5. Закоммитьте `.gitignore`:
   ```bash
   git add .gitignore
   git commit -m "Добавлен .gitignore для временных файлов"
   ```

---

## 6. Ветки, merge и rebase

### 6.1. Создание веток и коммиты

1. Создайте ветку `TEST`:
   ```bash
   git branch TEST
   ```

2. Создайте и переключитесь на ветку `PRERELEASE`:
   ```bash
   git checkout -b PRERELEASE
   ```

3. Переключитесь на ветку `TEST`:
   ```bash
   git checkout TEST
   ```

4. Создайте файл в ветке `TEST`:
   ```bash
   echo "Тестовый файл" > test.txt
   git add test.txt
   git commit -m "Добавлен test.txt в ветке TEST"
   ```

5. Переключитесь на ветку `PRERELEASE`:
   ```bash
   git checkout PRERELEASE
   ```

6. Создайте файл в ветке `PRERELEASE`:
   ```bash
   echo "Prerelease файл" > prerelease.txt
   git add prerelease.txt
   git commit -m "Добавлен prerelease.txt в ветке PRERELEASE"
   ```

7. Вернитесь в основную ветку:
   ```bash
   git checkout main
   ```

### 6.2. Слияние ветки `TEST` в `main`

1. Находясь в `main`, выполните слияние:
   ```bash
   git merge TEST
   ```

2. Проверьте, что файл `test.txt` появился:
   ```bash
   ls
   ```

### 6.3. Rebase `PRERELEASE` на `main`

1. Переключитесь в `PRERELEASE`:
   ```bash
   git checkout PRERELEASE
   ```

2. Выполните rebase:
   ```bash
   git rebase main
   ```

3. Посмотрите историю:
   ```bash
   git log --all --decorate --oneline --graph
   ```

---

## 7. Финальные файлы

1. Убедитесь, что вы в основной ветке:
   ```bash
   git checkout main
   ```

2. Создайте файл с логом:
   ```bash
   git log > ФамилияИО.txt
   ```

3. Добавьте и закоммитьте:
   ```bash
   git add ФамилияИО.txt
   git commit -m "Добавлен файл ФамилияИО.txt с историей коммитов"
   ```

4. Добавьте свою запись в файл:
   ```bash
   echo "ДД.ММ.ГГГГ ЧЧ:ММ Фамилия И.О." >> readme.txt
   ```
   (Пример: `09.02.2026 20:45 Иванов И.И.`)

5. Закоммитьте изменения:
   ```bash
   git add readme.txt
   git commit -m "Добавлена запись в readme.txt"
   ```

6. Отправьте все изменения в ваш репозиторий на GitHub:
   ```bash
   git push origin --all
   ```

---

## 8. Подготовка к сдаче через Fork и Pull Request

### 8.1. Создание форка общего репозитория

1. Перейдите в браузере на общий репозиторий практики:
   `https://github.com/SoftwareEngineering2026/Practice101`

2. Нажмите кнопку **Fork** (справа сверху) и создайте форк в своём GitHub‑аккаунте.

3. Склонируйте свой форк:
   ```bash
   cd ..
   git clone https://github.com/ВАШ_ЛОГИН/Practice101.git
   cd Practice101
   ```

### 8.2. Добавление своей работы в форк

В общем репозитории уже есть файл `readme.txt` (или он будет создан преподавателем). Ваша задача — добавить в этот файл свою запись и приложить файл с логом коммитов. 
1. Убедитесь, что вы находитесь в основной ветке форка (обычно `main`) и она актуальна:
   ```bash
   git checkout main
   git pull origin main
   ```

2. Создайте новую ветку для лабораторной работы:
   ```bash
   git checkout -b lab1-git
   ```

3. **Добавьте файл с логом**:
   Скопируйте файл `ФамилияИО.txt` из вашего личного репозитория в текущую папку форка:
   ```bash
   cp ../git-lab-вашафамилия/ФамилияИО.txt .
   ```
   Если файл уже существует в форке (например, от другого студента), переименуйте его, добавив свою фамилию.

4. **Добавьте запись в `readme.txt`**:
   Откройте файл `readme.txt` в редакторе и добавьте в конец строку с вашими данными в формате:
   ```
   ДД.ММ.ГГГГ ЧЧ:ММ Фамилия И.О.
   ```
   Сохраните файл.


5. **Закоммитьте изменения**:
   ```bash
   git add .
   git commit -m "Добавлена лабораторная работа: Фамилия И.О., группа"
   ```

6. **Отправьте ветку в свой форк**:
   ```bash
   git push origin lab1-git
   ```

### 8.2.1. Подготовка к созданию Pull Request: синхронизация с upstream

Перед открытием Pull Request необходимо убедиться, что ваша ветка содержит актуальные изменения из основного репозитория практики. Это снизит вероятность конфликтов.

1. **Добавьте ссылку на оригинальный репозиторий (`upstream`)**:
   ```bash
   git remote add upstream https://github.com/SoftwareEngineering2026/Practice101.git
   ```

2. **Получите последние изменения из `upstream`**:
   ```bash
   git fetch upstream
   ```

3. **Переключитесь на свою ветку**:
   ```bash
   git checkout lab1-git
   ```

4. **Обновите свою ветку, взяв изменения из основной ветки `upstream/main`** (выберите один из способов):

   - **Слияние (merge)** – сохраняет историю, создаёт дополнительный коммит слияния:
     ```bash
     git merge upstream/main
     ```

   - **Перебазирование (rebase)** – переписывает историю, делая её линейной (рекомендуется для личных веток):
     ```bash
     git rebase upstream/main
     ```

5. **Если возникнут конфликты**, Git сообщит об этом. Конфликтующие файлы нужно открыть в редакторе, найти маркеры конфликтов (`<<<<<<<`, `=======`, `>>>>>>>`) и вручную выбрать нужные изменения. После разрешения всех конфликтов:

   - Для **merge**: добавьте исправленные файлы и завершите слияние:
     ```bash
     git add .
     git commit         # коммит слияния создастся автоматически
     ```

   - Для **rebase**: добавьте исправленные файлы и продолжите перебазирование:
     ```bash
     git add .
     git rebase --continue
     ```

6. **Отправьте обновлённую ветку в свой форк**:
   ```bash
   git push origin lab1-git
   ```

### 8.3. Создание Pull Request

1. Откройте в браузере ваш форк `ВАШ_ЛОГИН/Practice101` на GitHub.

2. Перейдите во вкладку **Pull requests**.

3. Нажмите **New pull request**.

4. Выберите:
   - **base repository**: `SoftwareEngineering2026/Practice101`, ветка `main`
   - **head repository**: `ВАШ_ЛОГИН/Practice101`, ветка `lab1-git`

5. Проверьте список изменений во вкладке **Files changed**.

6. Заполните заголовок и описание:
   - Заголовок: `Лабораторная 1: Фамилия И.О., группа XXX`
   - Описание: перечислите, что сделано в работе (например, "Добавлен файл с логом, обновлён readme.txt, добавлены примеры работы с ветками").

7. Нажмите **Create pull request**.

---

## 9. Самопроверка (self‑review)

1. В вашем PR перейдите во вкладку **Files changed**.

2. Проверьте:
   - Наличие файла `ФамилияИО.txt` с корректной историей коммитов.
   - Наличие вашей записи в файле `readme.txt` (формат даты, времени, фамилии).
   - Отсутствие временных файлов (`.tmp`).
   - (Опционально) наличие `test.txt` и `prerelease.txt`, если вы их добавляли.

3. Если есть ошибки, исправьте их в локальном репозитории, сделайте коммит и запушьте в ту же ветку:
   ```bash
   git add .
   git commit -m "Исправления после самопроверки"
   git push origin lab1-git
   ```

---

## Что считается корректным результатом лабораторной

1. В вашем личном репозитории `git-lab-вашафамилия` выполнены все шаги работы.
2. В вашем форке `Practice101` создана ветка `lab1-git` с полным набором файлов:
   - `ФамилияИО.txt` – файл с логом коммитов из вашего личного репозитория.
   - `readme.txt` – обновлённый файл, содержащий вашу запись о сдаче.
3. На GitHub создан **Pull Request** из `ВАШ_ЛОГИН/Practice101:lab1-git` в `SoftwareEngineering2026/Practice101:main`.
4. **Сданная работа для студента = файл `ФамилияИО.txt` и добавление записи в `readme.txt`.**

Результат - pull request в репозиторий <https://github.com/SoftwareEngineering2026/Practice101>